var l=class extends Chart{constructor(a,t,r){let o=document.getElementById(a)?.getContext("2d");if(!o)throw Error("no context");let n={type:"line",options:{plugins:{legend:{display:!1}},scales:{x:r.x,y:r.y}},data:{datasets:t}};super(o,n);this._originalDatasets=t}filter(a){this.data.datasets=this._originalDatasets.filter(t=>t.label?.includes(a)),this.update()}};var m=class extends l{constructor(e,a){super(e,a,m.SCALES)}},u=m;u.SCALES={x:{title:{display:!0,text:"Date"},type:"time",time:{unit:"day",tooltipFormat:"DD/MM/YYYY",displayFormats:{day:"DD/MM/YYYY"}}},y:{title:{display:!0,text:"Total Load (all sets sum of weights * repetitions)"},beginAtZero:!0}};var h=class extends l{constructor(e,a){super(e,a,h.SCALES)}},d=h;d.SCALES={x:{title:{display:!0,text:"Date"},type:"time",time:{unit:"day",tooltipFormat:"DD/MM/YYYY",displayFormats:{day:"DD/MM/YYYY"}}},y:{title:{display:!0,text:"Repetitions"},beginAtZero:!0}};var x=class extends l{constructor(e,a){super(e,a,x.SCALES)}},p=x;p.SCALES={x:{type:"time",time:{unit:"day",tooltipFormat:"DD/MM/YYYY",displayFormats:{day:"DD/MM/YYYY"}},title:{display:!0,text:"Date"}},y:{title:{display:!0,text:"Weight (kg)"},beginAtZero:!0}};function c({rows:i,label:e,x:a,y:t}){let r=i.reduce((o,n)=>(o[n[e]]||(o[n[e]]={label:n[e],data:[]}),o[n[e]].data.push({x:n[a],y:n[t]}),o),{});return Object.values(r)}function w(i){let e=i.reduce((t,r)=>{let s=r.date;t[s]||(t[s]={});let o=r.exercise;return t[s][o]||(t[s][o]={...r,weight:-1/0}),r.weight>=t[s][o].weight&&(t[s][o]=r),t},{});return Object.keys(e).flatMap(t=>Object.values(e[t]))}function L(i){let e=i.reduce((t,r)=>{let s=r.date;t[s]||(t[s]={});let o=r.exercise;return t[s][o]||(t[s][o]={load:0,...r}),t[s][o].load+=r.weight*r.volume,t},{});return Object.keys(e).flatMap(t=>Object.values(e[t]))}function C(i){let e=i.reduce((t,r)=>{let s=r.date;return t[s]||(t[s]={load:0,...r}),t[s].load+=r.weight*r.volume,t},{});return Object.values(e)}var E=["bench","squat","deadlift","pull up","bicep","tricep"],b=["decline","bodyweight","close grip","assisted","cable","rope tricep pushdown"],R=50;function S({rows:i,label:e,minFrequency:a}){let r=c({rows:i,label:e,x:"date",y:"weight"}).reduce((s,o)=>(s[o.label]=o.data.length,s),{});return i.filter(s=>r[s[e]]>=a)}function D({rows:i,label:e,includes:a=[],excludes:t=[]}){return i.filter(r=>a.some(s=>r[e].toString().includes(s))&&t.every(s=>!r[e].toString().includes(s)))}function v(i){i=S({rows:i,label:"exercise",minFrequency:R}),i=D({rows:i,label:"exercise",includes:E,excludes:b});let e=w(i),a=c({rows:e,label:"exercise",x:"date",y:"weight"}),t=c({rows:e,label:"exercise",x:"date",y:"volume"}),r=c({rows:L(i),label:"exercise",x:"date",y:"load"}),s=c({rows:C(i),label:"date",x:"date",y:"load"});return{labels:i.map(o=>o.exercise),weights:a,volumes:t,exercisesLoad:r,workoutLoad:s}}var g=class{constructor({selectId:e,options:a,onChange:t}){let r=document.getElementById(e);if(!r)return;r.onchange=o=>t(o.target.value);let s=document.createElement("option");s.value="",s.textContent="",r.appendChild(s),[...new Set(a)].sort().forEach(o=>{let n=document.createElement("option");n.value=o,n.textContent=o,r.appendChild(n)})}};var f=class{constructor(e,a=";"){this._rows=this.buildRows(e,a)}rows(){return this._rows}buildRows(e,a){let t=e.split(`
`),r=t[0].split(a);return t.slice(1).map(o=>this.buildRow(r,o,a))}buildRow(e,a,t){let r=a.split(t),s={};for(let o=0;o<e.length;o++){let n=f.HEADERS_MAP[e[o]];n&&(s[n]=this.sanitizeValue(r[o]))}return s}sanitizeValue(e){return e.trim().replaceAll('"',"").toLowerCase()}},y=f;y.HEADERS_MAP={Date:"date","Exercise Name":"exercise",Weight:"weight",Reps:"volume"};async function A(i){return await(await fetch(i)).text()}async function Y(){let i=await A("data/workouts.csv"),a=new y(i).rows(),t=v(a),r=new p("heaviest-sets-weight-chart",t.weights),s=new d("heaviest-sets-volume-chart",t.volumes),o=new u("exercises-load-chart",t.exercisesLoad);new u("workout-load-chart",t.workoutLoad),new g({selectId:"exercises-filter",options:t.labels,onChange:n=>{r.filter(n),s.filter(n),o.filter(n)}})}document.addEventListener("DOMContentLoaded",async()=>await Y());
